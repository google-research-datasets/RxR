# RxR Landmarks and Model-Generated Instructions


### Reference

This data accompanies the CVPR 2022 publication
[Less is More: Generating Grounded Navigation Instructions from Landmarks](https://arxiv.org/abs/2111.12872).
It includes the bootstrapped 'silver' landmark dataset and 1m navigation
instructions generated by the Marky-mT5 model. For full details please refer to
the paper.

Bibtex:

```
@inproceedings{marky-landmark,
  title={Less is More: Generating Grounded Navigation Instructions from Landmarks},
  author={Su Wang and Ceslee Montgomery and Jordi Orbay and Vighnesh Birodkar and Aleksandra Faust and Izzeddin Gur and Natasha Jaques and Austin Waters and Jason Baldridge and Peter Anderson},
  booktitle={Computer Vision and Pattern Recognition (CVPR)},
  year={2022},
}
```

### Data Download

The data is released as gzipped [JSON Lines](https://jsonlines.org/), and can be
downloaded from the links below.


#### Silver Landmark Data

Using text parsers, weak supervision from RxR's pose traces, and a multilingual
image-text encoder trained on 1.8b images, we identify 1.1m English, Hindi and
Telugu landmark descriptions in RxR instructions and ground them to specific
regions in panoramas.

*   [`rxr_landmarks_train_guide` (63M)](https://storage.cloud.google.com/rxr-data/rxr_landmarks_train_guide.jsonl.gz)
*   [`rxr_landmarks_val_seen_guide` (7M)](https://storage.cloud.google.com/rxr-data/rxr_landmarks_val_seen_guide.jsonl.gz)
*   [`rxr_landmarks_val_unseen_guide` (10M)](https://storage.cloud.google.com/rxr-data/rxr_landmarks_val_unseen_guide.jsonl.gz)


#### Marky-mT5 Instructions

We sample ~333k paths in RxR train environments and annotate them with
high-quality navigation instructions generated by the Marky-mT5 model in
English, Hindi and Telugu (~1m instructions in total).

*   [`rxr_marky_train_guide` (255M)](https://storage.cloud.google.com/rxr-data/rxr_marky_train_guide.jsonl.gz)

### Data Format

We use the same fields as the RxR data wherever possible.

#### Silver Landmark Data

Each line in the jsonl data is a data item containing information about a single
instruction annotation from the RxR guide data, with the following data fields
available:

*   `language` (str) Language tag, `en`/`hi`/`te` for English/Hindi/Telugu.
*   `instruction_id` (int) Uniquely identifies the guide annotation.
*   `split` (str) The annotation split: `train`, `val_seen`, `val_unseen`.
*   `heading` (float) Agent’s initial heading.
*   `scan` (str) Uniquely identifies a scan in the Matterport3D environment.
*   `text_spans`: (List[str]) Landmark text spans extracted from the RxR guide
    instruction and grounded into the environment.
*   `text_spans_chars_start_indices` (List[int]) Start char indices of text
    spans in the RxR guide instruction.
*   `text_spans_chars_end_indices` (List[int]) End char indices of text spans
    in the RxR guide instruction.
*   `landmark_source_panos` (List[str]) List of panorama IDs, with one
    corresponding to each landmark.
*   `landmark_source_pano_indices` (List[int]) List of indices of the
    landmark_source_panos in the corresponding RxR guide path.
*   `landmark_bbox_coords`: (List[List[float]]) Bounding boxes that identify
    each landmark in an equirectangular pano centered on the Matterport3D y axis.
    Each bbox is a list of 4 floats [ymin, xmin, ymax, xmax], where each float
    is between 0-1, i.e. normalized coordinates.
*   `landmark_angle_coords` (List[List[float]]) Angle coordinates (matched with
    the bbox coords) – heading, pitch, hfov, vfov in radians. heading: from the
    Matterport3D y-axis, right is increasing. pitch: from the Matterport3D
    horizon (xy-plane), up is increasing. hfov: Horizontal field-of-view. vfov:
    Vertical field-of-view.
*   `instruction` (str) The navigation instruction, generated by Marky-mT5 using
    the silver landmarks. Note that this is *not* the RxR guide instruction and
    does not correspond to the `text_spans` field.

```python
{
  "language": "en",
  "instruction_id": 19930,
  "split": "train",
  "heading": 1.04,
  "scan": "1pXnuDYAj8r",
  "text_spans": ["laundry room", "hallway", "railing", "carpet",
                 "corridor", "office area", "hallway", "painting", ...],
  "text_span_chars_start_indices": [21, 57, 74, 90, 156, 201, ...],
  "text_span_chars_end_indices": [33, 64, 81, 96, 164, 212, 247, 265, ...],
  "landmark_source_panos": ["7d887c096fa64a81a02723f8c283ca16",
                          "7d887c096fa64a81a02723f8c283ca16",
                          "6a3fba49106e4a9fb40cd0bf47dd4d46", ...],
  "landmark_source_pano_indices": [0, 0, 1, 1, 2, 5, 6, 3, 6, 6, 9, 9, 10],
  "landmark_bbox_coords": [
    [0.3055555, 0.062690742, 0.80555558, 0.34575980],
    [0.3791666, 0.633478232, 0.79583334, 0.88623034],
    ...],
  "landmark_angle_coords": [
    [-1.85840737, -0.17453292, 1.57079637, 1.57079637],
    [1.63271260, -0.274889349, 1.30899691, 1.30899691],
    ...],
  "instruction": "You're starting in a laundry room, facing the
  railing. Walk out of this laundry room onto the wooden flooring.
  Turn right and go down the hallway toward the end of this hallway.
  ...",
}
```

#### Marky-mT5 Instructions

For the model-generated data, the data items are much simpler as we only
publish the Marky-generated instructions.

*   `language` (str) Language tag, `en`/`hi`/`te` for English/Hindi/Telugu.
*   `path_id` (int) Uniquely identifies a path sampled from the Matterport3D
    environment.
*   `instruction_id` (int) Uniquely identifies the instruction annotation.
*   `instruction` (str) The navigation instruction, generated by Marky-mT5 using
    landmarks predicted for the path.
*   `heading` (float) The initial heading in radians. Following R2R, the heading
    angle is zero facing the y-axis with z-up, and increases by turning right.
*   `scan` (str) Uniquely identifies a scan in the Matterport3D environment.
*   `path` (List[str]) A sequence of panoramic viewpoints along the path.
